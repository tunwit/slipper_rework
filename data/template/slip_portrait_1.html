<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salary Slip</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Noto+Sans+Thai:wght@100..900&display=swap" rel="stylesheet">
    <!--[if mso]>
    <noscript>
        <xml>
            <o:OfficeDocumentSettings>
                <o:AllowPNG/>
                <o:PixelsPerInch>96</o:PixelsPerInch>
            </o:OfficeDocumentSettings>
        </xml>
    </noscript>
    <![endif]-->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Noto+Sans+Thai:wght@100..900&display=swap');
        
        * {
            font-family: "Kanit", "Noto Sans Thai", Arial, Helvetica, sans-serif !important;
        }
    </style>
</head>
<body style="margin: 0; padding: 0; font-family: 'Kanit', 'Noto Sans Thai', Arial, Helvetica, sans-serif; background-color: #f8fafc; color: #1e293b; font-size: 12px; line-height: 1.4; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;">
    
    <!-- Wrapper table for email clients -->
    <table cellpadding="0" cellspacing="0" border="0" width="100%" style="background-color: #f8fafc; padding: 10px;">
        <tr>
            <td align="center">
                
                <!-- Main container -->
                <table cellpadding="0" cellspacing="0" border="0" style="max-width: 800px; width: 100%; background-color: #ffffff; border-radius: 6px; border: 1px solid #e2e8f0;">
                    
                    <!-- Header -->
                    <tr>
                        <td style="background-color: #1e293b; color: #ffffff; padding: 15px 20px; border-bottom: 3px solid #3b82f6;">
                            <table cellpadding="0" cellspacing="0" border="0" width="100%">
                                <tr>
                                    <td style="vertical-align: top;">
                                        <h1 style="margin: 0 0 6px 0; font-size: 20px; font-weight: 600; color: #ffffff;">{{ context.company.name }}</h1>
                                        <p style="margin: 0 0 3px 0; font-size: 12px; opacity: 0.9; color: #ffffff;">{{ context.company.address }}</p>
                                        <p style="margin: 0; font-size: 12px; opacity: 0.9; color: #ffffff;"><strong>{{ t('tax_id') }}</strong> {{ context.company.ID }}</p>
                                    </td>
                                    <td style="text-align: right; vertical-align: top;">
                                        <p style="margin: 0 0 5px 0; font-size: 20px; font-weight: 600; color: #ffffff;">{{ t('payslip') }}</p>
                                        <div style="font-size: 12px; color: #ffffff;">{{ context.payPeriod }}</div>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    
                    <!-- Content -->
                    <tr>
                        <td style="padding: 15px 20px;">
                            
                            <!-- Employee Information Section -->
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin-bottom: 15px;">
                                <tr>
                                    <td>
                                        <h2 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; border-bottom: 1px solid #e2e8f0; padding-bottom: 5px;">{{ t('employee_infomation') }}</h2>
                                        
                                        <!-- Info Grid using table -->
                                        <table cellpadding="12" cellspacing="0" border="0" width="100%" style="background-color: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; margin-bottom: 15px;">
                                            <tr>
                                                <td style="width: 25%; vertical-align: top;">
                                                    <div style="font-size: 10px; font-weight: 500; color: #64748b; text-transform: uppercase; margin-bottom: 2px;">{{ t('employee_id') }}</div>
                                                    <div style="font-size: 14px; font-weight: 600;">{{ context.employee.id }}</div>
                                                </td>
                                                <td style="width: 25%; vertical-align: top;">
                                                    <div style="font-size: 10px; font-weight: 500; color: #64748b; text-transform: uppercase; margin-bottom: 2px;">{{ t('employee_name') }}</div>
                                                    <div style="font-size: 14px; font-weight: 600;">{{ context.employee.name }}</div>
                                                </td>
                                                <td style="width: 25%; vertical-align: top;">
                                                    <div style="font-size: 10px; font-weight: 500; color: #64748b; text-transform: uppercase; margin-bottom: 2px;">{{ t('employee_position') }}</div>
                                                    <div style="font-size: 14px; font-weight: 600;">{{ context.employee.position }}</div>
                                                </td>
                                                <td style="width: 25%; vertical-align: top;">
                                                    <div style="font-size: 10px; font-weight: 500; color: #64748b; text-transform: uppercase; margin-bottom: 2px;">{{ t('employee_branch') }}</div>
                                                    <div style="font-size: 14px; font-weight: 600;">{{ context.employee.branch }}</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- Tables Container -->
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin-bottom: 15px;">
                                <tr>
                                    <!-- Earnings Table -->
                                    <td style="width: 48%; vertical-align: top; padding-right: 10px;">
                                        <h3 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; border-bottom: 1px solid #e2e8f0; padding-bottom: 5px;">{{ t('earnings') }}</h3>
                                        
                                        <table cellpadding="0" cellspacing="0" border="0" width="100%" style="border: 1px solid #e2e8f0; border-radius: 6px; background-color: #ffffff;">
                                            <tr style="background-color: #64748b;">
                                                <th style="color: #ffffff; padding: 8px 12px; text-align: left; font-size: 10px; text-transform: uppercase; font-weight: 600; border: none;">{{ t('description') }}</th>
                                                <th style="color: #ffffff; padding: 8px 12px; text-align: right; font-size: 10px; text-transform: uppercase; font-weight: 600; border: none;">{{ t('amount') }}</th>
                                            </tr>
                                            {% set earning_len = context.sections.earnings | length %}
                                            {% set deduction_len = context.sections.deduction | length %}
                                            {% set diff = deduction_len - earning_len %}
                                            {% for item in context.sections.earnings %}
                                            <tr{% if loop.index0 % 2 == 1 %} style="background-color: #f8fafc;"{% endif %}>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9;">{{ item.label }}</td>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9; text-align: right;">{{ item.formatted }} {{ item.unit }}</td>
                                            </tr>
                                            {% endfor %}
                                            {% if diff > 0 %}
                                            {% for i in range(diff) %}
                                            <tr{% if (context.sections.earnings | length + loop.index0) % 2 == 1 %} style="background-color: #f8fafc;"{% endif %}>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9;">&nbsp;</td>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9;">&nbsp;</td>
                                            </tr>
                                            {% endfor %}
                                            {% endif %}
                                            <tr style="background-color: #334155;">
                                                <td style="color: #ffffff; font-weight: 600; font-size: 12px; padding: 10px 12px; border: none;">{{ context.totals.earnings.label }}</td>
                                                <td style="color: #ffffff; font-weight: 600; font-size: 12px; padding: 10px 12px; border: none; text-align: right;">{{ context.totals.earnings.formatted }} {{ context.totals.earnings.unit }}</td>
                                            </tr>
                                        </table>
                                    </td>
                                    
                                    <!-- Spacer -->
                                    <td style="width: 4%;"></td>
                                    
                                    <!-- Deductions Table -->
                                    <td style="width: 48%; vertical-align: top; padding-left: 10px;">
                                        <h3 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; border-bottom: 1px solid #e2e8f0; padding-bottom: 5px;">{{ t('deduction') }}</h3>
                                        
                                        <table cellpadding="0" cellspacing="0" border="0" width="100%" style="border: 1px solid #e2e8f0; border-radius: 6px; background-color: #ffffff;">
                                            <tr style="background-color: #64748b;">
                                                <th style="color: #ffffff; padding: 8px 12px; text-align: left; font-size: 10px; text-transform: uppercase; font-weight: 600; border: none;">{{ t('description') }}</th>
                                                <th style="color: #ffffff; padding: 8px 12px; text-align: right; font-size: 10px; text-transform: uppercase; font-weight: 600; border: none;">{{ t('amount') }}</th>
                                            </tr>
                                            {% set diff = earning_len - deduction_len %}
                                            {% for item in context.sections.deduction %}
                                            <tr{% if loop.index0 % 2 == 1 %} style="background-color: #f8fafc;"{% endif %}>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9;">{{ item.label }}</td>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9; text-align: right;">{{ item.formatted }} {{ item.unit }}</td>
                                            </tr>
                                            {% endfor %}
                                            {% if diff > 0 %}
                                            {% for i in range(diff) %}
                                            <tr{% if (context.sections.deduction | length + loop.index0) % 2 == 1 %} style="background-color: #f8fafc;"{% endif %}>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9;">&nbsp;</td>
                                                <td style="font-size: 12px; padding: 6px 12px; border-bottom: 1px solid #f1f5f9;">&nbsp;</td>
                                            </tr>
                                            {% endfor %}
                                            {% endif %}
                                            <tr style="background-color: #334155;">
                                                <td style="color: #ffffff; font-weight: 600; font-size: 12px; padding: 10px 12px; border: none;">{{ context.totals.deduction.label }}</td>
                                                <td style="color: #ffffff; font-weight: 600; font-size: 12px; padding: 10px 12px; border: none; text-align: right;">{{ context.totals.deduction.formatted }} {{ context.totals.deduction.unit }}</td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- Additional Details Section -->
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin: 10px 0 15px 0;">
                                <tr>
                                    <td>
                                        <h3 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; border-bottom: 1px solid #e2e8f0; padding-bottom: 5px;">{{ t('details') }}</h3>
                                        
                                        <!-- Details Grid using table -->
                                        <table cellpadding="0" cellspacing="10" border="0" width="100%">
                                            <tr>
                                                {% for item in context.sections.details %}
                                                {% if loop.index0 % 3 == 0 and loop.index0 > 0 %}
                                            </tr>
                                            <tr>
                                                {% endif %}
                                                <td style="width: 33.33%; background-color: #f8fafc; padding: 10px; border-radius: 6px; border: 1px solid #e2e8f0; text-align: center; vertical-align: top;">
                                                    <div style="font-size: 12px; color: #64748b; text-transform: uppercase; margin-bottom: 5px; font-weight: 500;">{{ item.label }}</div>
                                                    <div style="font-size: 14px; font-weight: 600; color: #1e293b;">{{ item.formatted }} {{ item.unit }}</div>
                                                </td>
                                                {% if not loop.last and (loop.index % 3 != 0) %}
                                                <td style="width: 1%;"></td>
                                                {% endif %}
                                                {% endfor %}
                                                {% set remaining = 3 - (context.sections.details | length % 3) %}
                                                {% if remaining < 3 %}
                                                {% for i in range(remaining) %}
                                                <td style="width: 33.33%;"></td>
                                                {% if not loop.last %}<td style="width: 1%;"></td>{% endif %}
                                                {% endfor %}
                                                {% endif %}
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- Net Pay -->
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin: 15px 0;">
                                <tr>
                                    <td style="background-color: #1e293b; color: #ffffff; border-radius: 6px; padding: 15px; text-align: center; border-left: 4px solid #3b82f6;">
                                        <div style="font-size: 13px; font-weight: 500; margin-bottom: 5px; text-transform: uppercase;">{{ context.sections.net.label }}</div>
                                        <div style="font-size: 22px; font-weight: 700;">{{ context.sections.net.formatted }} {{ context.sections.net.unit }}</div>
                                    </td>
                                </tr>
                            </table>
                            
                            <!-- Note -->
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" style="margin-top: 15px;">
                                <tr>
                                    <td style="background-color: #f8fafc; border: 1px solid #cbd5e1; border-left: 4px solid #64748b; border-radius: 6px; padding: 12px; font-size: 12px; color: #475569;">
                                        <strong>Note:</strong> This is a system-generated document. No signature is required.
                                    </td>
                                </tr>
                            </table>
                            
                        </td>
                    </tr>
                    
                    <!-- Footer -->
                    <tr>
                        <td style="background-color: #f8fafc; padding: 12px 20px; text-align: center; font-size: 14px; color: #64748b; border-top: 1px solid #e2e8f0;">
                            <p style="margin: 0 0 5px 0;"><strong>{{ t('generatedon') }} {{ context.timeStamp }}</strong></p>
                            <p style="margin: 0;">{{ t('contactHR') }}</p>
                        </td>
                    </tr>
                    
                </table>
                
            </td>
        </tr>
    </table>
    
</body>
</html>